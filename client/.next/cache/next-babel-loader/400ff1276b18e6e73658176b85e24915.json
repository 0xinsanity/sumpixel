{"ast":null,"code":"import React, { useEffect, useState } from 'react';\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport { myFirebase } from '../lib/firebase';\nimport { getUser, getEmployer } from '../lib/server';\nimport Router from 'next/router';\nimport firebase from 'firebase';\nconst AuthConfig = {\n  signInFlow: 'popup',\n  callbacks: {\n    signInSuccessWithAuthResult: () => false\n  },\n  signInOptions: [firebase.auth.EmailAuthProvider.PROVIDER_ID]\n};\n\nconst Index = () => {\n  const [isSignedIn, setIsSignedIn] = useState(false);\n  const [userEmployer, setUserEmployer] = useState(undefined);\n  useEffect(() => {\n    myFirebase.auth().onAuthStateChanged(user => {\n      console.log(user);\n\n      if (user != null) {\n        setIsSignedIn(true);\n        setUserEmployer({\n          email: myFirebase.auth().currentUser.email,\n          id: myFirebase.auth().currentUser.uid,\n          firstName: myFirebase.auth().currentUser.displayName.substr(0, user.displayName.indexOf(' ')),\n          lastName: myFirebase.auth().currentUser.displayName.substr(user.displayName.indexOf(' ') + 1)\n        });\n      }\n    });\n  });\n  useEffect(() => {\n    async function findUser() {\n      console.log(myFirebase.auth().currentUser);\n\n      if (myFirebase.auth().currentUser === null) {\n        return;\n      }\n\n      console.log('hit here');\n      const user = await getUser(myFirebase.auth().currentUser.uid);\n      const employer = await getEmployer(myFirebase.auth().currentUser.uid);\n\n      if (user['user_exists'] == undefined) {\n        Router.replace('/dashboard_user');\n      } else if (employer['employer_exists'] == undefined) {\n        Router.replace('/dashboard_employer');\n      } else {\n        Router.replace('/signup');\n      }\n    }\n\n    findUser();\n  }, [myFirebase.auth().currentUser]);\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"p\", null, \"test\"), /*#__PURE__*/React.createElement(StyledFirebaseAuth, {\n    uiConfig: AuthConfig,\n    firebaseAuth: myFirebase.auth()\n  }));\n};\n\nexport default Index;","map":{"version":3,"sources":["/Users/insanity/Documents/personalprojects/sumpixel-client/pages/index.tsx"],"names":["React","useEffect","useState","StyledFirebaseAuth","myFirebase","getUser","getEmployer","Router","firebase","AuthConfig","signInFlow","callbacks","signInSuccessWithAuthResult","signInOptions","auth","EmailAuthProvider","PROVIDER_ID","Index","isSignedIn","setIsSignedIn","userEmployer","setUserEmployer","undefined","onAuthStateChanged","user","console","log","email","currentUser","id","uid","firstName","displayName","substr","indexOf","lastName","findUser","employer","replace"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport {myFirebase} from '../lib/firebase'\nimport {User, Employer} from '../model/model'\nimport {getUser, getEmployer} from '../lib/server'\nimport Router from 'next/router'\nimport firebase from 'firebase'\n\nconst AuthConfig = {\n    signInFlow: 'popup',\n    callbacks: {\n        signInSuccessWithAuthResult: () => false\n    },\n    signInOptions: [\n        firebase.auth.EmailAuthProvider.PROVIDER_ID\n    ]\n};\n\nconst Index: React.FC = () => {\n    const [isSignedIn, setIsSignedIn] = useState(false);\n    const [userEmployer, setUserEmployer] = useState<User | Employer | undefined>(undefined);\n    useEffect(() => {\n        myFirebase.auth().onAuthStateChanged(user => {\n            console.log(user)\n            if (user != null) {\n                setIsSignedIn(true)\n                setUserEmployer({\n                    email: myFirebase.auth().currentUser.email,\n                    id: myFirebase.auth().currentUser.uid,\n                    firstName: myFirebase.auth().currentUser.displayName.substr(0, user.displayName.indexOf(' ')),\n                    lastName: myFirebase.auth().currentUser.displayName.substr(user.displayName.indexOf(' ')+1),\n                });\n            }\n        });\n    });\n\n    useEffect(() => {\n        async function findUser() {\n            console.log(myFirebase.auth().currentUser)\n            if (myFirebase.auth().currentUser === null) {return}\n            console.log('hit here')\n            const user = await getUser(myFirebase.auth().currentUser.uid)\n            const employer = await getEmployer(myFirebase.auth().currentUser.uid)\n\n            if (user['user_exists'] == undefined) {\n                Router.replace('/dashboard_user')\n            } else if (employer['employer_exists'] == undefined) {\n                Router.replace('/dashboard_employer')\n            } else {\n                Router.replace('/signup')\n            }\n        }\n        findUser()\n    }, [myFirebase.auth().currentUser])\n\n    return (\n        <div>\n            <p>test</p>\n            <StyledFirebaseAuth\n                uiConfig={AuthConfig}\n                firebaseAuth={myFirebase.auth()}/>\n        </div>\n    );\n};\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}