{"ast":null,"code":"import React, { useEffect, useState, useContext, useRef } from 'react';\nimport { Tabs } from 'antd';\nimport { Container } from '../components/General/Container';\nimport NavigationBar from '../components/Dashboard/NavigationBar';\nimport FormBusinessData from '../components/OnboardingFlow/Employers/FormBusinessData';\nimport FindDesigners from '../components/Dashboard/Employer/FindDesigners';\nimport ManageCommunications from '../components/Dashboard/Employer/ManageCommunications';\nimport { UserContext } from '../lib/UserProvider';\nimport { UNIVERSAL_BACKGROUND } from '../model/model';\nimport { modifyEmployer } from '../lib/server';\nimport Head from 'next/head';\nimport styled from 'styled-components';\nimport { useRouter } from 'next/router';\nimport { myFirebase } from '../lib/firebase';\nimport firebase from 'firebase';\nimport OpenPage from '../components/General/OpenPage';\nconst {\n  TabPane\n} = Tabs;\nconst TabObjs = [{\n  name: \"Designers\",\n  key: \"1\"\n}, {\n  name: \"Communications\",\n  key: \"2\"\n}, {\n  name: \"Profile\",\n  key: \"3\"\n}];\nexport const Background = styled.div.withConfig({\n  displayName: \"dashboard_employer__Background\",\n  componentId: \"sc-1yrkndj-0\"\n})([\"background-color:\", \";width:100%;flex-direction:column;flex:1;justify-content:center;align-items:center;overflow:scroll;\"], UNIVERSAL_BACKGROUND);\n\nconst DashboardEmployer = props => {\n  const {\n    currentUser,\n    changeUser,\n    setLoading\n  } = useContext(UserContext);\n  const {\n    asPath,\n    query\n  } = useRouter();\n  const [isAnonymousHere, setAnonymous] = useState(false); // This is done to access isAnonymous value within timeout\n\n  const anon = useRef(isAnonymousHere);\n  anon.current = isAnonymousHere;\n  useEffect(() => {\n    window.analytics.page('Employer Dashboard');\n    setTimeout(() => {\n      // currentUser not updated so have to resort to custom state to prevent going back\n      if (!anon.current && (currentUser === null || currentUser === undefined)) {\n        OpenPage(setLoading, '/');\n      }\n    }, 3000);\n\n    const anonymousLogin = async () => {\n      console.log(asPath.substr(asPath.indexOf('=') + 1));\n      console.log(query.id);\n\n      if (asPath.substr(asPath.indexOf('=') + 1) === \"60fff552-280b-47ae-b632-25a744a7a910\") {\n        console.log('gets here');\n        console.log(asPath.substr(asPath.indexOf('=') + 1));\n        myFirebase.auth().setPersistence(firebase.auth.Auth.Persistence.NONE);\n        myFirebase.auth().signInAnonymously().then(() => {\n          console.log('currentuser ' + currentUser);\n          setAnonymous(true);\n          console.log('signed in anon');\n        });\n      }\n    };\n\n    anonymousLogin();\n  }, []);\n  useEffect(() => {\n    if (currentUser !== null && currentUser !== undefined) {\n      setLoading(false);\n    }\n  }, [currentUser]);\n\n  if (currentUser === null || currentUser === undefined) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null);\n  }\n\n  const updateEmployer = async updatedUser => {\n    window.analytics.track('Modify Employer');\n    changeUser(updatedUser);\n    await modifyEmployer(updatedUser);\n  };\n\n  const isAnonymous = currentUser !== null && currentUser.isAnonymous !== undefined;\n  console.log('anon: ' + isAnonymous);\n  var footer;\n\n  if (isAnonymous) {\n    footer = /*#__PURE__*/React.createElement(Tabs, {\n      tabBarGutter: 40,\n      defaultActiveKey: \"1\"\n    }, /*#__PURE__*/React.createElement(TabPane, {\n      tab: TabObjs[0].name,\n      key: TabObjs[0].key\n    }, /*#__PURE__*/React.createElement(Background, null, /*#__PURE__*/React.createElement(Container, {\n      isDashboard: true\n    }, /*#__PURE__*/React.createElement(FindDesigners, null)))));\n  } else {\n    footer = /*#__PURE__*/React.createElement(Tabs, {\n      tabBarGutter: 40,\n      defaultActiveKey: \"1\"\n    }, /*#__PURE__*/React.createElement(TabPane, {\n      tab: TabObjs[0].name,\n      key: TabObjs[0].key\n    }, /*#__PURE__*/React.createElement(Background, null, /*#__PURE__*/React.createElement(Container, {\n      isDashboard: true\n    }, /*#__PURE__*/React.createElement(FindDesigners, null)))), /*#__PURE__*/React.createElement(TabPane, {\n      tab: TabObjs[1].name,\n      key: TabObjs[1].key\n    }, /*#__PURE__*/React.createElement(Background, null, /*#__PURE__*/React.createElement(Container, {\n      isDashboard: true\n    }, /*#__PURE__*/React.createElement(ManageCommunications, null)))), /*#__PURE__*/React.createElement(TabPane, {\n      tab: TabObjs[2].name,\n      key: TabObjs[2].key\n    }, /*#__PURE__*/React.createElement(Background, null, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        padding: 40,\n        justifyContent: 'center'\n      }\n    }, /*#__PURE__*/React.createElement(FormBusinessData, {\n      changeCurrentUser: updateEmployer,\n      modifyProfile: true\n    })))));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Head, null, /*#__PURE__*/React.createElement(\"title\", null, \"Employer Dashboard\")), /*#__PURE__*/React.createElement(NavigationBar, {\n    isDesigner: false,\n    subtitle: isAnonymous ? 'Dashboard' : `${currentUser.firstName}'s Dashboard`,\n    footer: footer\n  }));\n};\n\nexport default DashboardEmployer;","map":{"version":3,"sources":["/Users/insanity/Documents/Sumpixel/sumpixel/client/pages/dashboard_employer.tsx"],"names":["React","useEffect","useState","useContext","useRef","Tabs","Container","NavigationBar","FormBusinessData","FindDesigners","ManageCommunications","UserContext","UNIVERSAL_BACKGROUND","modifyEmployer","Head","styled","useRouter","myFirebase","firebase","OpenPage","TabPane","TabObjs","name","key","Background","div","DashboardEmployer","props","currentUser","changeUser","setLoading","asPath","query","isAnonymousHere","setAnonymous","anon","current","window","analytics","page","setTimeout","undefined","anonymousLogin","console","log","substr","indexOf","id","auth","setPersistence","Auth","Persistence","NONE","signInAnonymously","then","updateEmployer","updatedUser","track","isAnonymous","footer","display","padding","justifyContent","firstName"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useContext, useRef} from 'react'\nimport {Tabs} from 'antd'\nimport Loading from '../components/General/Loading'\nimport {Container} from '../components/General/Container'\nimport NavigationBar from '../components/Dashboard/NavigationBar'\nimport FormBusinessData from '../components/OnboardingFlow/Employers/FormBusinessData'\nimport FindDesigners from '../components/Dashboard/Employer/FindDesigners'\nimport ManageCommunications from '../components/Dashboard/Employer/ManageCommunications'\nimport {UserContext} from '../lib/UserProvider'\nimport {Employer, UNIVERSAL_BACKGROUND} from '../model/model'\nimport { modifyEmployer} from '../lib/server'\nimport Head from 'next/head'\nimport styled from 'styled-components'\nimport {useRouter} from 'next/router'\nimport {myFirebase} from '../lib/firebase'\nimport firebase from 'firebase'\nimport OpenPage from '../components/General/OpenPage'\nconst {TabPane} = Tabs\n\nconst TabObjs = [{name: \"Designers\", key: \"1\"}, \n                {name: \"Communications\", key: \"2\"}, \n                {name: \"Profile\", key: \"3\"}]\n\nexport const Background = styled.div`\n    background-color: ${UNIVERSAL_BACKGROUND};\n    width: 100%;\n    flex-direction: column;\n    flex: 1;\n    justify-content: center;\n    align-items: center;\n    overflow: scroll;\n`\n\nconst DashboardEmployer: React.FC = (props) => {\n    const {currentUser, changeUser, setLoading}  = useContext(UserContext)\n    const {asPath, query} = useRouter()\n    const [isAnonymousHere, setAnonymous] = useState(false)\n\n    // This is done to access isAnonymous value within timeout\n    const anon = useRef(isAnonymousHere);\n    anon.current = isAnonymousHere;\n    useEffect(() => {\n        window.analytics.page('Employer Dashboard')\n        setTimeout(() => {\n            // currentUser not updated so have to resort to custom state to prevent going back\n            if (!anon.current && (currentUser === null || currentUser === undefined)) {\n                OpenPage(setLoading, '/')\n            }\n        }, 3000)\n        const anonymousLogin = async () => {\n            console.log(asPath.substr(asPath.indexOf('=') + 1))\n            console.log(query.id)\n            if (asPath.substr(asPath.indexOf('=') + 1) === \"60fff552-280b-47ae-b632-25a744a7a910\") {\n                console.log('gets here')\n                console.log(asPath.substr(asPath.indexOf('=') + 1))\n                myFirebase.auth().setPersistence(firebase.auth.Auth.Persistence.NONE)\n                myFirebase.auth().signInAnonymously().then(() => {\n                    console.log('currentuser ' + currentUser)\n                    setAnonymous(true)\n                    console.log('signed in anon')\n                })\n            }\n        }\n        anonymousLogin()\n    }, [])\n\n    useEffect(() => {\n        if (currentUser !== null && currentUser !== undefined) {\n            setLoading(false)\n        }\n    }, [currentUser])\n\n    if (currentUser === null || currentUser === undefined) {\n        return (<></>)\n    }\n\n    const updateEmployer = async (updatedUser: Employer) => {\n        window.analytics.track('Modify Employer');\n        changeUser(updatedUser)\n        await modifyEmployer(updatedUser)\n    }\n\n    const isAnonymous = currentUser !== null && (currentUser as Employer).isAnonymous !== undefined\n    console.log('anon: ' + isAnonymous)\n    var footer: React.ReactNode\n    if (isAnonymous) {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    } else {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[1].name} key={TabObjs[1].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <ManageCommunications/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[2].name} key={TabObjs[2].key}>\n                        <Background>\n                            <div style={{display: 'flex', padding: 40, justifyContent: 'center'}}>\n                                <FormBusinessData changeCurrentUser={updateEmployer} modifyProfile={true} />\n                            </div>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    }\n\n    return (\n        <>\n            <Head>\n                <title>Employer Dashboard</title>\n            </Head>\n            <NavigationBar \n                isDesigner={false}\n                subtitle={isAnonymous ? 'Dashboard' : `${currentUser.firstName}'s Dashboard`}\n                footer={footer}\n            />\n        </>\n    );\n};\n\nexport default DashboardEmployer;"]},"metadata":{},"sourceType":"module"}