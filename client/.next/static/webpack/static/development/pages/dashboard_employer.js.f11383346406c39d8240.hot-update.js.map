{"version":3,"file":"static/webpack/static/development/pages/dashboard_employer.js.f11383346406c39d8240.hot-update.js","sources":["webpack:///./components/Dashboard/NavigationBar.tsx","webpack:///./lib/UserProvider.tsx","webpack:///./pages/dashboard_employer.tsx"],"sourcesContent":["import React, {useState, useContext} from 'react'\nimport {PageHeader, Button, Tabs, message, Typography} from 'antd'\nimport {myFirebase} from '../../lib/firebase'\nimport Router from 'next/router'\nimport Loading from '../General/Loading'\nimport {Employer} from '../../model/model'\nimport { UserContext } from '../../lib/UserProvider'\nimport styled from 'styled-components'\n\nconst {TabPane} = Tabs\n\nconst SumpixelHeader = styled(PageHeader)`\n    background: #DAE2EF;\n    padding: 30px 8%;\n    min-height: 100vh;\n`\n\nconst LogoutButton = styled(Button)`\n    color: #000000;\n    padding-top: 10px;\n`\nconst Line = styled.div`\n    border: 0.5px solid #000000;\n    margin-top: 10px;\n    margin-bottom: 10px;\n`\n\nconst SubTitle = styled(Typography.Title)`\n    font-family: 'Mark Pro Bold';\n    padding-top: 20px;\n    padding-bottom: 10px;\n`\n\ninterface NavigationBarProps {\n    subtitle: string\n    footer: React.ReactNode\n    isDesigner: boolean\n}\n\nconst NavigationBar: React.FC<NavigationBarProps> = (props) => {\n    const {subtitle, footer, isDesigner} = props\n    const {currentUser, changeUser} = useContext(UserContext)\n    const [loading, setLoading] = useState(false)\n\n    if (loading) {\n        return (<Loading/>)\n    }\n\n    return (\n        <SumpixelHeader \n                title={ <a href={isDesigner ? '/dashboard_user' : '/dashboard_employer'}>\n                            <img height={43} src={require('../../assets/sumpixel-logo.png')}/>\n                        </a>}\n                extra={[\n                    <LogoutButton type=\"link\" onClick={async () => {\n                        myFirebase.auth().signOut().then(() => {\n                            changeUser(undefined)\n                            setLoading(false)\n                            if ((currentUser as Employer).isAnonymous !== undefined) {\n                                Router.replace('/signup')\n                            } else {\n                                Router.replace('/')\n                            }\n                        }).catch((error) => {\n                            message.error(error.message)\n                        })\n                    }}>\n                        {(currentUser as Employer).isAnonymous === undefined ? 'Log Out' : 'Create Account To Start Connecting With Designers'}\n                    </LogoutButton>\n                ]}\n                footer={footer}>\n            <Line/>            \n            <SubTitle>{subtitle}</SubTitle>\n        </SumpixelHeader>\n    )\n}\n\nexport default NavigationBar","import React, { Component, createContext } from \"react\";\nimport { myFirebase } from \"./firebase\";\nimport {User, Employer} from '../model/model'\nimport {getEmployer, getUser} from './server'\nimport Router from \"next/router\";\nimport {message} from 'antd'\nimport Loading from '../components/General/Loading'\n\ninterface ContextProps {\n    currentUser: User | Employer | null,\n    changeUser: (newUser: User | Employer | null) => void\n}\n\nexport const UserContext = createContext<Partial<ContextProps>>({\n    currentUser: null,\n    changeUser: () => {}\n});\nclass UserProvider extends Component {\n  changeUser = (newUser: User | Employer | null) => {\n      this.setState({currentUser: newUser, loading: false})\n  }\n\n  state = {\n    loading: false,\n    currentUser: null,\n    changeUser: this.changeUser\n  };\n\n  componentDidMount = () => {\n    myFirebase.auth().onAuthStateChanged(async (userAuth) => {\n        this.setState({loading: true})\n        if (userAuth === null) {\n            this.setState({loading: false})\n            return\n        }\n\n        if (userAuth.isAnonymous) {\n          console.log('userauth:' + userAuth)\n          this.changeUser({\n            firstName: '',\n            lastName: '',\n            email: '',\n            id: userAuth.uid,\n            isAnonymous: true\n          } as Employer)\n          return\n        }\n\n        // This is some of the worst code I've ever made\n        var current;\n        try {\n          current = await getUser(userAuth.uid)\n        } catch (error) {\n          try {\n            current = await getEmployer(userAuth.uid)\n            current[\"user_exists\"] = false\n          } catch (error) {\n            console.log(\"this better be a new user\")\n          }\n        }\n\n        if (current !== undefined && current['user_exists'] === undefined) {\n            this.changeUser(current as User)\n            window.analytics.identify(current.id, {\n              name: current.name,\n              email: current.email\n            });\n            Router.replace('/dashboard_user')\n        } else if (current !== undefined && current['employer_exists'] === undefined) {\n            window.analytics.identify(current.id, {\n              name: current.name,\n              email: current.email\n            });\n            this.changeUser(current as Employer)\n            Router.push('/dashboard_employer')\n        } else {\n            // TODO: Find alternate way to wait until names are updated\n            // Works for both\n            setTimeout(() => {\n                this.changeUser({\n                    email: userAuth.email,\n                    id: userAuth.uid,\n                    firstName: userAuth.displayName.substr(0, userAuth.displayName.indexOf(' ')),\n                    lastName: userAuth.displayName.substr(userAuth.displayName.indexOf(' ')+1),\n                })\n            }, 500)\n            \n        }\n    });\n  };\n  render() {\n    if (this.state.loading) {\n      return (<Loading/>)\n    }\n\n    return (\n      <UserContext.Provider value={this.state}>\n        {this.props.children}\n      </UserContext.Provider>\n    );\n  }\n}\nexport default UserProvider;","import React, {useEffect, useState, useContext} from 'react'\nimport {Tabs} from 'antd'\nimport Loading from '../components/General/Loading'\nimport {Container} from '../components/General/Container'\nimport NavigationBar from '../components/Dashboard/NavigationBar'\nimport FormBusinessData from '../components/OnboardingFlow/Employers/FormBusinessData'\nimport FindDesigners from '../components/Dashboard/Employer/FindDesigners'\nimport ManageCommunications from '../components/Dashboard/Employer/ManageCommunications'\nimport {UserContext} from '../lib/UserProvider'\nimport {Employer, UNIVERSAL_BACKGROUND} from '../model/model'\nimport { modifyEmployer} from '../lib/server'\nimport Head from 'next/head'\nimport styled from 'styled-components'\nimport {useRouter} from 'next/router'\nimport {myFirebase} from '../lib/firebase'\nconst {TabPane} = Tabs\n\nconst TabObjs = [{name: \"Designers\", key: \"1\"}, \n                {name: \"Communications\", key: \"2\"}, \n                {name: \"Profile\", key: \"3\"}]\n\nexport const Background = styled.div`\n    background-color: ${UNIVERSAL_BACKGROUND};\n    width: 100%;\n    overflow: scroll;\n`\n\nconst DashboardEmployer: React.FC = (props) => {\n    const {currentUser, changeUser}  = useContext(UserContext)\n    const {asPath, query} = useRouter()\n    \n    if (query.id === \"60fff552-280b-47ae-b632-25a744a7a910\" && currentUser === null) {\n        console.log('gets here')\n        myFirebase.auth().signInAnonymously()\n    }\n\n    useEffect(() => {\n        window.analytics.page('Employer Dashboard')\n    }, [])\n\n    const updateEmployer = async (updatedUser: Employer) => {\n        window.analytics.track('Modify Employer');\n        changeUser(updatedUser)\n        await modifyEmployer(updatedUser)\n    }\n\n    if (currentUser === undefined || currentUser === null) {\n        return (<Loading />)\n    }\n\n    var footer: React.ReactNode\n    if ((currentUser as Employer).isAnonymous !== undefined) {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    } else {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[1].name} key={TabObjs[1].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <ManageCommunications/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[2].name} key={TabObjs[2].key}>\n                        <Background>\n                            <div style={{display: 'flex', padding: 40, justifyContent: 'left'}}>\n                                <FormBusinessData changeCurrentUser={updateEmployer} modifyProfile={true} />\n                            </div>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    }\n\n    return (\n        <>\n            <Head>\n                <title>Employer Dashboard</title>\n            </Head>\n            <NavigationBar \n                isDesigner={false}\n                subtitle={(currentUser as Employer).isAnonymous === undefined ? `${currentUser.firstName}'s Dashboard` : 'Temporary Dashboard'}\n                footer={footer}\n            />\n        </>\n    );\n};\n\nexport default DashboardEmployer;"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AACA;AAWA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAgBA;AArBA;AA0BA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AC7EA;AACA;AAEA;AACA;AAEA;AAOA;AACA;AACA;AAFA;AACA;AAGA;AAAA;AAAA;AACA;AADA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAHA;AACA;AANA;AAYA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AAEA;AACA;AACA;AAxEA;AACA;AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAIA;AACA;AApFA;AACA;AAoFA;;;;;;;;;;;;ACtGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAKA;AACA;AACA;AAMA;AACA;AACA;AAHA;AAOA;AACA;AACA;;;;A","sourceRoot":""}