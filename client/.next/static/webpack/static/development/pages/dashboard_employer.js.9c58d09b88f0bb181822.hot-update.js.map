{"version":3,"file":"static/webpack/static/development/pages/dashboard_employer.js.9c58d09b88f0bb181822.hot-update.js","sources":["webpack:///./pages/dashboard_employer.tsx"],"sourcesContent":["import React, {useEffect, useState, useContext, useRef} from 'react'\nimport {Tabs} from 'antd'\nimport Loading from '../components/General/Loading'\nimport {Container} from '../components/General/Container'\nimport NavigationBar from '../components/Dashboard/NavigationBar'\nimport FormBusinessData from '../components/OnboardingFlow/Employers/FormBusinessData'\nimport FindDesigners from '../components/Dashboard/Employer/FindDesigners'\nimport ManageCommunications from '../components/Dashboard/Employer/ManageCommunications'\nimport {UserContext} from '../lib/UserProvider'\nimport {Employer, UNIVERSAL_BACKGROUND} from '../model/model'\nimport { modifyEmployer} from '../lib/server'\nimport Head from 'next/head'\nimport styled from 'styled-components'\nimport {useRouter} from 'next/router'\nimport {myFirebase} from '../lib/firebase'\nimport firebase from 'firebase'\nimport OpenPage from '../components/General/OpenPage'\nconst {TabPane} = Tabs\n\nconst TabObjs = [{name: \"Designers\", key: \"1\"}, \n                {name: \"Communications\", key: \"2\"}, \n                {name: \"Profile\", key: \"3\"}]\n\nexport const Background = styled.div`\n    background-color: ${UNIVERSAL_BACKGROUND};\n    width: 100%;\n    flex-direction: column;\n    flex: 1;\n    justify-content: center;\n    align-items: center;\n    overflow: scroll;\n`\n\nconst DashboardEmployer: React.FC = (props) => {\n    const {currentUser, changeUser, setLoading}  = useContext(UserContext)\n    const {asPath, query} = useRouter()\n    const [isAnonymousHere, setAnonymous] = useState(false)\n\n    // This is done to access isAnonymous value within timeout\n    const anon = useRef(isAnonymousHere);\n    anon.current = isAnonymousHere;\n    useEffect(() => {\n        window.analytics.page('Employer Dashboard')\n        setTimeout(() => {\n            // currentUser not updated so have to resort to custom state to prevent going back\n            if (!anon.current && (currentUser === null || currentUser === undefined)) {\n                OpenPage(setLoading, '/')\n            }\n        }, 3000)\n        const anonymousLogin = async () => {\n            console.log(asPath.substr(asPath.indexOf('=') + 1))\n            console.log(query.id)\n            if (asPath.substr(asPath.indexOf('=') + 1) === \"60fff552-280b-47ae-b632-25a744a7a910\") {\n                console.log('gets here')\n                console.log(asPath.substr(asPath.indexOf('=') + 1))\n                myFirebase.auth().setPersistence(firebase.auth.Auth.Persistence.NONE)\n                myFirebase.auth().signInAnonymously().then(() => {\n                    console.log('currentuser ' + currentUser)\n                    setAnonymous(true)\n                    console.log('signed in anon')\n                })\n            }\n        }\n        anonymousLogin()\n    }, [])\n\n    useEffect(() => {\n        if (currentUser !== null && currentUser !== undefined) {\n            setLoading(false)\n        }\n    }, [currentUser])\n\n    if (currentUser === null || currentUser === undefined) {\n        return (<></>)\n    }\n\n    const updateEmployer = async (updatedUser: Employer) => {\n        window.analytics.track('Modify Employer');\n        changeUser(updatedUser)\n        await modifyEmployer(updatedUser)\n    }\n\n    const isAnonymous = currentUser !== null && (currentUser as Employer).isAnonymous !== undefined\n    console.log('anon: ' + isAnonymous)\n    var footer: React.ReactNode\n    if (isAnonymous) {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    } else {\n        footer = <Tabs tabBarGutter={40} defaultActiveKey=\"1\">\n                    <TabPane tab={TabObjs[0].name} key={TabObjs[0].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <FindDesigners/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[1].name} key={TabObjs[1].key}>\n                        <Background>\n                            <Container isDashboard={true}>\n                                <ManageCommunications/>\n                            </Container>\n                        </Background>\n                    </TabPane>\n                    <TabPane tab={TabObjs[2].name} key={TabObjs[2].key}>\n                        <Background>\n                            <div style={{display: 'flex', padding: 40, justifyContent: 'center'}}>\n                                <FormBusinessData changeCurrentUser={updateEmployer} modifyProfile={true} />\n                            </div>\n                        </Background>\n                    </TabPane>\n                </Tabs>\n    }\n\n    return (\n        <>\n            <Head>\n                <title>Employer Dashboard</title>\n            </Head>\n            <NavigationBar \n                isDesigner={false}\n                subtitle={isAnonymous ? 'Dashboard' : `${currentUser.firstName}'s Dashboard`}\n                footer={footer}\n            />\n        </>\n    );\n};\n\nexport default DashboardEmployer;"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AASA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AAKA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAKA;AACA;AACA;AAMA;AACA;AACA;AAHA;AAOA;AACA;AACA;;;;A","sourceRoot":""}